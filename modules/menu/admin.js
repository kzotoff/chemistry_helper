$(function() {	$('#button_add').on('click', function() { editMenuItem(); });	$('.admin_menu_tree').find('[data-button-action="moveup"]').on('click', function(event) {		var id = $(this).closest('li').attr('data-element-id');		location.href = './?module=menu&id='+id+'&action=moveup';		event.stopPropagation();	});	$('.admin_menu_tree').find('[data-button-action="movedown"]').on('click', function(event) {		var id = $(this).closest('li').attr('data-element-id');		location.href = './?module=menu&id='+id+'&action=movedown';		event.stopPropagation();	});	$('.admin_menu_tree').find('[data-button-action="edit"]').on('click', function(event) {		editMenuItem($(this));		event.stopPropagation();	});	$('.admin_menu_tree').find('[data-button-action="delete"]').on('click', function(event) {		deleteMenuItem($(this));		event.stopPropagation();	});	$('.admin_menu_tree span').on('click', function(event) {		editMenuItem($(this));		event.stopPropagation();	});});// calls edit form for menu item// if source is undefined, or nothing is found, id will be set to -1 (means new element)function editMenuItem(source) {	var id = $(source).closest('li').attr('data-element-id');	if (typeof(id) == 'undefined') {		id = -1;	}	backgroundLock();	$.get('./?ajaxproxy=menu&module=menu&action=edit_elem&id='+id)		.done(function(result) {			$('<div id="edit_dialog"></div>')				.html(result)				.dialog({					title: (id < 0 ? 'Новый элемент' : 'Свойства элемента (ID: '+id+')'),					modal: true,					width: '70rem',					close: function() {						$('#edit_dialog').remove();						backgroundRelease();					}				});				// install submit-button locker				$('.admin_edit_form').on('submit', function() {					$(this).find('input[type="submit"]').attr('disabled', 'disabled');				});				$('#edit_picture').on('click', function() {					simpleFilemanager.start('pictures', $(this));				});				$('#edit_xsl').on('click', function() {					simpleFilemanager.start('xsl', $(this));				});						});};deleteMenuItem = function(source) {	var id = $(source).closest('li').attr('data-element-id');	if (confirm('really delete?')) {		location.href = './?module=menu&id='+id+'&action=delete';	}}